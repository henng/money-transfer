# money-transfer
A sample code of transferring money.

## 描述信息


> 题目：请编写【2个用户之间转账功能的接口及其内部实现】的核心代码，尽量是一个可以运行的代码程序

> 要求：完成接口设计、并实现其内部逻辑，以完成A用户转账给B用户的功能。2个用户的账户不在同一个数据库下。注意尽量不要用伪代码。

> 提示：接口发布后会暴露给外部应用进行服务调用，请考虑接口规范、安全、幂等、重试、并发、有可能的异常分支、分布式场景下事务一致性、用户投诉、资金安全等的处理。


## 思路简述

由于2个账户不在同一个数据库下，因此本地事务无法完全满足需要；
整体上，采用本地消息表 + 消息队列 MQ 来实现，相当于部分消息队列产品里的事务消息，例如 JMQ、RocketMQ 等等。
为了演示简单方便，这里使用前一种方案。

具体到各个部分

- 接口规范：入参校验
- 接口安全：token 加密
- 幂等、重试：使用一个唯一 ID，保证每个 ID 只实际执行一次；
接口幂等后，可以允许多次重试
- 异常、边界：例如余额不足等
- 事务一致性：要么都成功，要么都不执行
- 用户投诉：记下转账日志，用户账户明细；如果有投诉，以便有记录可查
- 资金安全：先减钱、后加钱

## 运行方法
运行 com.antgroup.moneytransfer.test.TransferTest 类下的 testMoneyTransfer() 方法即可。

## 待续

由于时间关系，本次项目中还有值得改善的地方：

- 更多测试用例的覆盖
- 部分实现可以更具体和完善
- 交互可以更友好
